# ğŸš€ Multi-Server Subscription Manager v3.1

ĞšĞ¾Ğ¼Ğ¿Ğ»ĞµĞºÑĞ½Ğ°Ñ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ½ĞµÑĞºĞ¾Ğ»ÑŒĞºĞ¸Ğ¼Ğ¸ ÑĞµÑ€Ğ²ĞµÑ€Ğ°Ğ¼Ğ¸ Ñ ÑĞ¾Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğ¼ React Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹ÑĞ¾Ğ¼.

## âœ¨ Ğ§Ñ‚Ğ¾ Ğ½Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ² v3.1

### ğŸ¨ Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ñ‚ĞµĞ¼
- â˜€ï¸ Ğ¡Ğ²ĞµÑ‚Ğ»Ğ°Ñ Ğ¸ ğŸŒ™ Ñ‚ĞµĞ¼Ğ½Ğ°Ñ Ñ‚ĞµĞ¼Ğ°
- ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ°
- ĞŸĞµÑ€ĞµĞºĞ»ÑÑ‡Ğ°Ñ‚ĞµĞ»ÑŒ Ğ² Ğ½Ğ°Ğ²Ğ¸Ğ³Ğ°Ñ†Ğ¸Ğ¸
- [Screenshots](./screens.md)

### ğŸ“Š ĞĞ¾Ğ²Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹

#### 1. **ClientManager** - Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğ°Ğ¼Ğ¸
- âœ… Batch Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğ¾Ğ² (Ğ¼Ğ½Ğ¾Ğ¶ĞµÑÑ‚Ğ²ĞµĞ½Ğ½Ğ°Ñ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ°)
- ğŸ—‘ï¸ ĞœĞ°ÑÑĞ¾Ğ²Ğ¾Ğµ ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ (Ğ¿Ğ¾ ÑÑ‚Ğ°Ñ‚ÑƒÑÑƒ: expired, depleted)
- ğŸ”„ Ğ¡Ğ±Ñ€Ğ¾Ñ Ñ‚Ñ€Ğ°Ñ„Ğ¸ĞºĞ° (Ğ¸Ğ½Ğ´Ğ¸Ğ²Ğ¸Ğ´ÑƒĞ°Ğ»ÑŒĞ½Ğ¾ Ğ¸Ğ»Ğ¸ Ğ²ÑĞµÑ…)
- ğŸ” Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ ÑƒĞ·Ğ»Ğ°Ğ¼, Ğ¿Ñ€Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ»Ğ°Ğ¼, ÑÑ‚Ğ°Ñ‚ÑƒÑÑƒ
- ğŸ“¥ Ğ­ĞºÑĞ¿Ğ¾Ñ€Ñ‚ Ğ² CSV
- âœ”ï¸ ĞœĞ½Ğ¾Ğ¶ĞµÑÑ‚Ğ²ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ²Ñ‹Ğ±Ğ¾Ñ€ Ñ Ñ‡ĞµĞºĞ±Ğ¾ĞºÑĞ°Ğ¼Ğ¸

#### 2. **TrafficStats** - Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ñ‚Ñ€Ğ°Ñ„Ğ¸ĞºĞ°
- ğŸ“Š Bar charts (Top N ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğ¾Ğ²/ÑĞµÑ€Ğ²ĞµÑ€Ğ¾Ğ²)
- ğŸ¥§ Pie charts (Upload/Download Ñ€Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ)
- ğŸ“ˆ Ğ“Ñ€ÑƒĞ¿Ğ¿Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ¿Ğ¾: Client / Inbound / Node
- ğŸŸ¢ Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ¾Ğ½Ğ»Ğ°Ğ¹Ğ½ ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğ¾Ğ² Ğ² Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸
- ğŸ“‰ ĞĞ´Ğ°Ğ¿Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ğµ Ğ³Ñ€Ğ°Ñ„Ğ¸ĞºĞ¸ Ñ Chart.js

#### 3. **BackupManager** - Ğ‘ÑĞºĞ°Ğ¿/Ğ’Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ
- ğŸ’¾ Ğ¡ĞºĞ°Ñ‡Ğ¸Ğ²Ğ°Ğ½Ğ¸Ğµ backup Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ ÑĞµÑ€Ğ²ĞµÑ€Ğ°
- ğŸ“¦ ĞœĞ°ÑÑĞ¾Ğ²Ğ¾Ğµ ÑĞºĞ°Ñ‡Ğ¸Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ²ÑĞµÑ… backup (ZIP Ğ°Ñ€Ñ…Ğ¸Ğ²)
- ğŸ“¤ Ğ’Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ database Ğ¸Ğ· .db Ñ„Ğ°Ğ¹Ğ»Ğ°
- âš ï¸ ĞŸÑ€ĞµĞ´ÑƒĞ¿Ñ€ĞµĞ¶Ğ´ĞµĞ½Ğ¸Ñ Ğ¿Ñ€Ğ¸ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸ÑÑ…
- ğŸ¤– Ğ˜Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ğ¸ Ğ¿Ğ¾ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ (cron)

#### 4. **ServerStatus** - ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³
- ğŸ–¥ï¸ CPU, RAM, Disk usage Ñ Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑ-Ğ±Ğ°Ñ€Ğ°Ğ¼Ğ¸
- âš¡ Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ core-ÑĞµÑ€Ğ²Ğ¸ÑĞ° (Ğ²ĞµÑ€ÑĞ¸Ñ, uptime)
- ğŸ”„ ĞŸĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑĞº core-ÑĞµÑ€Ğ²Ğ¸ÑĞ° Ğ¾Ğ´Ğ½Ğ¾Ğ¹ ĞºĞ½Ğ¾Ğ¿ĞºĞ¾Ğ¹
- ğŸŒ Ğ¡ĞµÑ‚ĞµĞ²Ğ¾Ğ¹ Ñ‚Ñ€Ğ°Ñ„Ğ¸Ğº Ğ² Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸
- â™»ï¸ Auto-refresh Ñ Ğ½Ğ°ÑÑ‚Ñ€Ğ°Ğ¸Ğ²Ğ°ĞµĞ¼Ñ‹Ğ¼ Ğ¸Ğ½Ñ‚ĞµÑ€Ğ²Ğ°Ğ»Ğ¾Ğ¼

#### 6. **AdGuard Integration** - DNS Ğ°Ğ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ° Ğ±ĞµĞ· Ğ°Ğ³ĞµĞ½Ñ‚Ğ¾Ğ²
- ğŸ”Œ ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ ÑƒĞ´Ğ°Ğ»Ñ‘Ğ½Ğ½Ñ‹Ñ… AdGuard Home Ğ¿Ğ¾ `admin URL + login/password`
- ğŸ“ˆ Ğ¡Ğ±Ğ¾Ñ€ DNS KPI: queries, blocked rate, latency, cache hit ratio, upstream errors
- ğŸ§  Top blocked domains Ğ¸ top clients
- ğŸ—ƒï¸ Ğ˜ÑÑ‚Ğ¾Ñ€Ğ¸Ñ snapshots ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑĞµÑ‚ÑÑ Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾ Ğ² `admin.db` (`adguard_history`)
- ğŸ›¡ï¸ ĞŸĞ°Ñ€Ğ¾Ğ»Ğ¸ Ğ¸ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸ĞºĞ¾Ğ² ÑˆĞ¸Ñ„Ñ€ÑƒÑÑ‚ÑÑ Ñ‚ĞµĞ¼ Ğ¶Ğµ ĞºĞ»ÑÑ‡Ğ¾Ğ¼, Ñ‡Ñ‚Ğ¾ Ğ¸ Ğ´Ğ»Ñ ÑƒĞ·Ğ»Ğ¾Ğ² node panel

#### 5. **InboundManager** - Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Inbound
- ğŸ“¡ ĞŸÑ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ Ğ²ÑĞµÑ… inbound ÑĞ¾ Ğ²ÑĞµÑ… ÑĞµÑ€Ğ²ĞµÑ€Ğ¾Ğ²
- ğŸ¯ Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ Ğ¿Ñ€Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ»Ñƒ, security, ÑƒĞ·Ğ»Ñƒ
- ğŸ“‹ ĞšĞ»Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ inbound Ğ½Ğ° Ğ´Ñ€ÑƒĞ³Ğ¸Ğµ ÑĞµÑ€Ğ²ĞµÑ€Ñ‹
- ğŸ”’ ĞÑ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ Reality/TLS ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¹

## ğŸ—ï¸ ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         React Frontend (Vite)           â”‚
â”‚  - 8 Ñ‚Ğ°Ğ±Ğ¾Ğ² Ğ½Ğ°Ğ²Ğ¸Ğ³Ğ°Ñ†Ğ¸Ğ¸                    â”‚
â”‚  - Chart.js Ğ³Ñ€Ğ°Ñ„Ğ¸ĞºĞ¸                      â”‚
â”‚  - Light/Dark theme                      â”‚
â”‚  - Bootstrap UI                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ REST API (Basic Auth)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      FastAPI Backend (Python)           â”‚
â”‚  - 27+ API endpoints                    â”‚
â”‚  - PAM Ğ°Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ                      â”‚
â”‚  - Multi-threaded requests              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                 â”‚                â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”
â”‚ node panel â”‚      â”‚ node panel   â”‚      â”‚ node panel  â”‚
â”‚ Node1 â”‚      â”‚ Node2   â”‚      â”‚ Node3  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ ÑÑ‚Ğ°Ñ€Ñ‚

### Ğ¢Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
- Ubuntu 24.04 (Ğ¸Ğ»Ğ¸ 20.04+)
- Root Ğ´Ğ¾ÑÑ‚ÑƒĞ¿
- Nginx ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½ Ğ¸ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞ½
- Node.js 20+ (ÑƒÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµÑ‚ÑÑ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ ÑĞºÑ€Ğ¸Ğ¿Ñ‚Ğ¾Ğ¼ install.sh)

### Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ°
```bash
git clone https://github.com/Efidripy/multiserversubgen
cd multiserversubgen
chmod +x install.sh
sudo ./install.sh
```

Ğ¡ĞºÑ€Ğ¸Ğ¿Ñ‚ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚:
- âœ… Python 3 + venv + Ğ²ÑĞµ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸
- âœ… Node.js + npm + React ÑĞ±Ğ¾Ñ€ĞºÑƒ
- âœ… Nginx ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ Ñ proxy_pass
- âœ… Systemd ÑĞµÑ€Ğ²Ğ¸Ñ
- âœ… Fail2ban Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ñƒ
- âœ… Prometheus + Grafana (Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾, Ğ¿Ğ¾ Ğ²Ğ¾Ğ¿Ñ€Ğ¾ÑÑƒ Ğ² ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ñ‰Ğ¸ĞºĞµ)
  - Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ Ğº Grafana Ğ·Ğ°ĞºÑ€Ñ‹Ñ‚ BasicAuth (Ğ»Ğ¾Ğ³Ğ¸Ğ½/Ğ¿Ğ°Ñ€Ğ¾Ğ»ÑŒ Ğ·Ğ°Ğ´Ğ°ÑÑ‚ÑÑ Ğ² install.sh)

### ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ (Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµĞ¼Ñ‹Ğ¹ Ğ¿Ğ¾Ñ€ÑĞ´Ğ¾Ğº)
```bash
git pull
sudo ./update.sh
```

Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµÑ‚ÑÑ Ğ¿ĞµÑ€ĞµĞ´ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸ĞµĞ¼ ÑĞ´ĞµĞ»Ğ°Ñ‚ÑŒ backup:
```bash
curl -u admin:password https://your-domain/my-panel/api/v1/backup/all \
  -o backups_$(date +%Y%m%d).zip
```

Ğ’ `update.sh` Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹ Ñ€ĞµĞ¶Ğ¸Ğ¼Ñ‹:
1. ĞŸĞ¾Ğ»Ğ½Ğ¾Ğµ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ (backend + frontend)
2. Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ backend
3. Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ frontend
4. Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ Nginx ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³

## ğŸ“ Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°

```
multiserversubgen/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ main.py                # FastAPI Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ
â”‚   â”œâ”€â”€ client_manager.py      # Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğ°Ğ¼Ğ¸
â”‚   â”œâ”€â”€ inbound_manager.py     # Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ inbound
â”‚   â”œâ”€â”€ server_monitor.py      # ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ ÑĞµÑ€Ğ²ĞµÑ€Ğ¾Ğ²
â”‚   â”œâ”€â”€ websocket_manager.py   # WebSocket ÑĞ»Ğ¾Ğ¹
â”‚   â”œâ”€â”€ services/              # Collector + AdGuard ÑĞµÑ€Ğ²Ğ¸ÑÑ‹
â”‚   â”œâ”€â”€ routers/               # ĞÑ‚Ğ´ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ñ€Ğ¾ÑƒÑ‚ĞµÑ€Ñ‹ API
â”‚   â””â”€â”€ tests/                 # Unit/Ñ€ĞµĞ³Ñ€ĞµÑÑĞ¸Ğ¾Ğ½Ğ½Ñ‹Ğµ Ñ‚ĞµÑÑ‚Ñ‹
â”‚
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ contexts/
â”‚   â”‚   â”‚   â””â”€â”€ ThemeContext.tsx     # Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ñ‚ĞµĞ¼
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ ClientManager.tsx    # Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğ°Ğ¼Ğ¸
â”‚   â”‚   â”‚   â”œâ”€â”€ TrafficStats.tsx     # Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ñ‚Ñ€Ğ°Ñ„Ğ¸ĞºĞ°
â”‚   â”‚   â”‚   â”œâ”€â”€ BackupManager.tsx    # Ğ‘ÑĞºĞ°Ğ¿Ñ‹
â”‚   â”‚   â”‚   â”œâ”€â”€ ServerStatus.tsx     # ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³
â”‚   â”‚   â”‚   â”œâ”€â”€ InboundManager.tsx   # Inbound
â”‚   â”‚   â”‚   â”œâ”€â”€ NodeManager.tsx      # Ğ¡ĞµÑ€Ğ²ĞµÑ€Ñ‹
â”‚   â”‚   â”‚   â””â”€â”€ SubscriptionManager.tsx  # ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑĞºĞ¸
â”‚   â”‚   â”œâ”€â”€ App.tsx                  # Ğ“Ğ»Ğ°Ğ²Ğ½Ğ¾Ğµ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ
â”‚   â”‚   â””â”€â”€ main.tsx
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ install.sh              # Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ñ‰Ğ¸Ğº
â”œâ”€â”€ update.sh              # ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ
â”œâ”€â”€ API_DOCUMENTATION.md   # API Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ
â””â”€â”€ COMPONENTS_GUIDE.md    # Ğ ÑƒĞºĞ¾Ğ²Ğ¾Ğ´ÑÑ‚Ğ²Ğ¾ Ğ¿Ğ¾ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ°Ğ¼
```

## ğŸ”§ ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ

### Backend
- ĞŸĞ¾Ñ€Ñ‚: `666` (Ğ½Ğ°ÑÑ‚Ñ€Ğ°Ğ¸Ğ²Ğ°ĞµÑ‚ÑÑ Ğ¿Ñ€Ğ¸ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞµ)
- ĞŸÑƒÑ‚ÑŒ: `/opt/sub-manager/` (Ğ¸Ğ»Ğ¸ custom)
- Ğ›Ğ¾Ğ³: `journalctl -u sub-manager -f`
- Runtime hardening env:
  - `ALLOW_ORIGINS` â€” CORS whitelist (Ñ‡ĞµÑ€ĞµĞ· Ğ·Ğ°Ğ¿ÑÑ‚ÑƒÑ)
  - `VERIFY_TLS` (`true/false`) â€” Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° TLS Ğº node panel ÑƒĞ·Ğ»Ğ°Ğ¼
  - `CA_BUNDLE_PATH` â€” Ğ¿ÑƒÑ‚ÑŒ Ğº ĞºĞ°ÑÑ‚Ğ¾Ğ¼Ğ½Ğ¾Ğ¼Ñƒ CA bundle (Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾)
  - `READ_ONLY_MODE` (`true/false`) â€” Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€ÑƒĞµÑ‚ `POST/PUT/DELETE/PATCH` Ğ´Ğ»Ñ `/api/v1/*`
  - `SUB_RATE_LIMIT_COUNT` + `SUB_RATE_LIMIT_WINDOW_SEC` â€” Ğ»Ğ¸Ğ¼Ğ¸Ñ‚ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ² Ğº `/api/v1/sub/*`
  - `TRAFFIC_STATS_CACHE_TTL`, `ONLINE_CLIENTS_CACHE_TTL` â€” ĞºĞ¾Ñ€Ğ¾Ñ‚ĞºĞ¸Ğ¹ cache Ğ´Ğ»Ñ Ğ¼ĞµÑ‚Ñ€Ğ¸Ğº Ğ² Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸
  - `TRAFFIC_MAX_WORKERS` â€” Ğ¿Ğ°Ñ€Ğ°Ğ»Ğ»ĞµĞ»Ğ¸Ğ·Ğ¼ ÑĞ±Ğ¾Ñ€Ğ° ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ¸ Ğ¿Ğ¾ ÑƒĞ·Ğ»Ğ°Ğ¼
  - `COLLECTOR_BASE_INTERVAL_SEC`, `COLLECTOR_MAX_INTERVAL_SEC`, `COLLECTOR_MAX_PARALLEL` â€” adaptive background collector
  - `REDIS_URL` â€” optional Redis cache backend (Ğ´Ğ»Ñ Ğ¿ĞµÑ€ĞµĞ¶Ğ¸Ğ²Ğ°Ğ½Ğ¸Ñ Ñ€ĞµÑÑ‚Ğ°Ñ€Ñ‚Ğ¾Ğ² Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ°)
  - `AUDIT_QUEUE_BATCH_SIZE` â€” batch size Ğ´Ğ»Ñ Ñ„Ğ¾Ğ½Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ´Ñ€ĞµĞ½Ğ°Ğ¶Ğ° persistent audit queue
  - `ROLE_VIEWERS`, `ROLE_OPERATORS` â€” RBAC ÑĞ¿Ğ¸ÑĞºĞ¸ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹ Ñ‡ĞµÑ€ĞµĞ· Ğ·Ğ°Ğ¿ÑÑ‚ÑƒÑ (`admin` Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ Ğ´Ğ»Ñ Ğ¾ÑÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ñ…)
  - `MFA_TOTP_ENABLED`, `MFA_TOTP_USERS` â€” optional TOTP 2FA Ğ´Ğ»Ñ Ğ²ÑĞµÑ… Ğ·Ğ°Ñ‰Ğ¸Ñ‰Ñ‘Ğ½Ğ½Ñ‹Ñ… `/api/v1/*` Ğ¸ WebSocket (`username:BASE32` Ñ‡ĞµÑ€ĞµĞ· Ğ·Ğ°Ğ¿ÑÑ‚ÑƒÑ)

### Observability
- `GET /metrics` â€” Prometheus-Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸ HTTP (request count + latency)
- `GET /api/v1/snapshots/latest` â€” Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğ¹ snapshot Ğ¾Ñ‚ background collector
- `GET /api/v1/health/deps` â€” readiness Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ĞµĞ¹ (collector/redis)

Monitoring assets:
- `monitoring/prometheus/rules.yml` â€” alert rules (p95 latency, 5xx rate)
- `monitoring/grafana/sub-manager-dashboard.json` â€” Ğ±Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ dashboard
- `monitoring/grafana/adguard-overview-dashboard.json` â€” dashboard Ğ´Ğ»Ñ AdGuard (Prometheus + Loki)
- `monitoring/loki/loki-config.yml` â€” Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ single-node Loki
- `monitoring/promtail/promtail-config.yml` â€” ÑĞ±Ğ¾Ñ€ querylog/journal AdGuard Ğ² Loki
- Install/update scripts Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸:
  - ÑĞ¾Ğ·Ğ´Ğ°ÑÑ‚ scrape Ğ´Ğ»Ñ `http://127.0.0.1:<APP_PORT>/metrics`
  - Ğ¿Ñ€Ğ¸ Ğ²ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¸ `ADGUARD_METRICS_ENABLED=true` Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ÑÑÑ‚ scrape AdGuard:
    - targets Ğ¸Ğ· `ADGUARD_METRICS_TARGETS` (Ñ‡ĞµÑ€ĞµĞ· Ğ·Ğ°Ğ¿ÑÑ‚ÑƒÑ, Ğ½Ğ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€ `127.0.0.1:3000,10.0.0.12:3000`)
    - path Ğ¸Ğ· `ADGUARD_METRICS_PATH` (Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ `/control/prometheus/metrics`)
  - Ğ¿Ñ€Ğ¸ Ğ²ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¸ `ADGUARD_LOKI_ENABLED=true` ÑƒÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ÑÑ‚ `loki` + `promtail` Ğ¸ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡Ğ°ÑÑ‚ datasource `Loki` Ğ² Grafana
    - `ADGUARD_QUERYLOG_PATH` (Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ `/opt/AdGuardHome/data/querylog.json`)
    - `ADGUARD_SYSTEMD_UNIT` (Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ `AdGuardHome.service`)
  - Ğ²ĞºĞ»ÑÑ‡Ğ°ÑÑ‚ provisioning datasource/dashboard Ğ² Grafana
  - Ğ¿ÑƒĞ±Ğ»Ğ¸ĞºÑƒÑÑ‚ Grafana Ñ‡ĞµÑ€ĞµĞ· subpath `/$WEB_PATH/grafana/` Ğ² Nginx
  - Ğ¾Ñ‚ĞºĞ»ÑÑ‡Ğ°ÑÑ‚ `auth.anonymous` Ğ² Grafana Ğ¸ Ğ±Ğ¸Ğ½Ğ´ÑƒÑÑ‚ ĞµÑ‘ Ğ½Ğ° `127.0.0.1:3000`
  - Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°ÑÑ‚ IP allowlist Ğ¸ optional mTLS (ĞºĞ»Ğ¸ĞµĞ½Ñ‚ÑĞºĞ¸Ğµ ÑĞµÑ€Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ‚Ñ‹) Ğ´Ğ»Ñ Ğ¿ÑƒÑ‚ĞµĞ¹ Ğ¿Ğ°Ğ½ĞµĞ»Ğ¸

Ğ‘Ñ‹ÑÑ‚Ñ€Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¿Ğ¾ÑĞ»Ğµ Ğ²ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ AdGuard-Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¸:
```bash
sudo systemctl status prometheus grafana-server loki promtail --no-pager
curl -s http://127.0.0.1:9090/api/v1/targets | jq '.data.activeTargets[] | {job:.labels.job, health:.health}'
curl -s http://127.0.0.1:3100/ready
```

### Frontend
- Ğ¡Ğ±Ğ¾Ñ€ĞºĞ°: `backend/build/`
- ĞŸÑƒÑ‚ÑŒ Ğ² Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€Ğµ: `https://your-domain/my-panel/` (Ğ½Ğ°ÑÑ‚Ñ€Ğ°Ğ¸Ğ²Ğ°ĞµÑ‚ÑÑ)
- API Ğ¿Ñ€Ğ¾ĞºÑĞ¸ Ñ‡ĞµÑ€ĞµĞ· Nginx
- Subpath Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ°: ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ñ‰Ğ¸Ğº Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ²Ñ‹ÑÑ‚Ğ°Ğ²Ğ»ÑĞµÑ‚ `VITE_BASE` Ğ½Ğ° Ğ¾ÑĞ½Ğ¾Ğ²Ğµ Ğ²Ğ²ĞµĞ´Ñ‘Ğ½Ğ½Ğ¾Ğ³Ğ¾ Ğ¿ÑƒÑ‚Ğ¸. Ğ”Ğ»Ñ Ñ€ÑƒÑ‡Ğ½Ğ¾Ğ¹ ÑĞ±Ğ¾Ñ€ĞºĞ¸ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ `VITE_BASE="/my-panel/" npm run build`

### API Base URL (subpath deployment)

Ğ¤Ñ€Ğ¾Ğ½Ñ‚ĞµĞ½Ğ´ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ÑĞµÑ‚ Ğ±Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ URL Ğ´Ğ»Ñ API Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸:

| ĞŸĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ğ°Ñ | ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ |
|---|---|---|
| `VITE_API_BASE_URL` | 1 (Ğ²Ñ‹ÑˆĞµ) | Ğ¯Ğ²Ğ½Ñ‹Ğ¹ override. ĞŸÑ€Ğ¸Ğ¼ĞµÑ€: `https://api.example.com` |
| `BASE_URL` (= `VITE_BASE`) | 2 (Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ) | ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ²Ñ‹Ğ²Ğ¾Ğ´Ğ¸Ñ‚ÑÑ Ğ¸Ğ· Ğ¿ÑƒÑ‚Ğ¸ Ğ´ĞµĞ¿Ğ»Ğ¾Ñ |

**ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ñ‹:**

| `VITE_BASE` | Ğ˜Ñ‚Ğ¾Ğ³Ğ¾Ğ²Ñ‹Ğ¹ `API_BASE` | URL API-Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ² |
|---|---|---|
| `/` (Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ) | `/api` | `https://domain/api/v1/...` |
| `/my-panel/` | `/my-panel/api` | `https://domain/my-panel/api/v1/...` |
| `/panel/` | `/panel/api` | `https://domain/panel/api/v1/...` |

Nginx-ÑĞ½Ğ¸Ğ¿Ğ¿ĞµÑ‚, Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµĞ¼Ñ‹Ğ¹ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ñ‰Ğ¸ĞºĞ¾Ğ¼, Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ ÑĞ¾Ğ²Ğ¿Ğ°Ğ´Ğ°ĞµÑ‚ Ñ ÑÑ‚Ğ¸Ğ¼Ğ¸ Ğ¿ÑƒÑ‚ÑĞ¼Ğ¸:
```nginx
location ^~ /my-panel/api/ { proxy_pass http://127.0.0.1:666/api/; ... }
location ^~ /my-panel/      { alias /opt/sub-manager/build/; ... }
```

> **âš ï¸ Ğ’Ğ°Ğ¶Ğ½Ğ¾:** ĞĞµ Ğ¾Ñ‚ĞºÑ€Ñ‹Ğ²Ğ°Ğ¹Ñ‚Ğµ `/api/` Ğ½Ğ° ĞºĞ¾Ñ€Ğ½ĞµĞ²Ğ¾Ğ¼ ÑƒÑ€Ğ¾Ğ²Ğ½Ğµ Ğ² nginx Ğ±ĞµĞ· Ğ½ĞµĞ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸.
> Ğ­Ñ‚Ğ¾ Ñ€Ğ°ÑĞºÑ€Ñ‹Ğ²Ğ°ĞµÑ‚ API Ğ½Ğ° ĞºĞ¾Ñ€Ğ½Ğµ Ğ´Ğ¾Ğ¼ĞµĞ½Ğ° Ğ¸ ÑĞ²Ğ»ÑĞµÑ‚ÑÑ Ñ€Ğ¸ÑĞºĞ¾Ğ¼ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚Ğ¸.
> Ğ•ÑĞ»Ğ¸ Ğ½ÑƒĞ¶Ğ½Ğ° ÑĞ¾Ğ²Ğ¼ĞµÑÑ‚Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ, Ğ´Ğ¾Ğ±Ğ°Ğ²ÑŒÑ‚Ğµ Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ location `/api/` ÑĞ²Ğ½Ğ¾ Ğ² vhost-ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³
> Ñ Ğ¿Ğ¾Ğ¼ĞµÑ‚ĞºĞ¾Ğ¹ â€” Ğ½Ğ¾ ÑÑ‚Ğ¾ Ğ½Ğµ Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµÑ‚ÑÑ Ğ´Ğ»Ñ production-Ğ´ĞµĞ¿Ğ»Ğ¾Ñ.

### Ğ‘Ğ°Ğ·Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
- SQLite: `/opt/sub-manager/nodes.db`
- ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¸ Ğ¿ĞµÑ€Ğ²Ğ¾Ğ¼ Ğ·Ğ°Ğ¿ÑƒÑĞºĞµ
- Backup Ñ‡ĞµÑ€ĞµĞ· API Ğ¸Ğ»Ğ¸ BackupManager UI

## ğŸ” Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ

- âœ… PAM Ğ°Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ (ÑĞ¸ÑÑ‚ĞµĞ¼Ğ½Ñ‹Ğµ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ğ¸)
- âœ… Basic Auth Ğ´Ğ»Ñ Ğ²ÑĞµÑ… API ÑĞ½Ğ´Ğ¿Ğ¾Ğ¸Ğ½Ñ‚Ğ¾Ğ²
- âœ… Fail2ban Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ (Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğ° Ğ¾Ñ‚ Ğ±Ñ€ÑƒÑ‚Ñ„Ğ¾Ñ€ÑĞ°)
- âœ… Nginx rate limiting
- âš ï¸ HTTPS Ğ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ĞµĞ½ Ğ´Ğ»Ñ production

## ğŸ“š Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ

- **API Documentation:** [API_DOCUMENTATION.md](./API_DOCUMENTATION.md)
  - 27+ ÑĞ½Ğ´Ğ¿Ğ¾Ğ¸Ğ½Ñ‚Ğ¾Ğ²
  - ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ñ‹ cURL Ğ¸ Python
  - ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ Ğ²ÑĞµÑ… Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ²

- **Components Guide:** [COMPONENTS_GUIDE.md](./COMPONENTS_GUIDE.md)
  - Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ°
  - Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ĞµĞ¹
  - API endpoints Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ°
  - Troubleshooting

## ğŸ¯ API ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ñ‹

> Ğ—Ğ°Ğ¼ĞµĞ½Ğ¸Ñ‚Ğµ `your-domain/my-panel` Ğ½Ğ° Ğ²Ğ°Ñˆ Ğ´Ğ¾Ğ¼ĞµĞ½ Ğ¸ Ğ¿ÑƒÑ‚ÑŒ Ğ´ĞµĞ¿Ğ»Ğ¾Ñ.

### ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ ÑÑ‚Ğ°Ñ‚ÑƒÑ ÑĞµÑ€Ğ²ĞµÑ€Ğ¾Ğ²
```bash
curl -u admin:password https://your-domain/my-panel/api/v1/servers/status
```

### Batch Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğ¾Ğ²
```bash
curl -u admin:password -X POST https://your-domain/my-panel/api/v1/clients/batch-add \
  -H "Content-Type: application/json" \
  -d '{
    "inbound_id": 1,
    "clients": [
      {"email": "user1@example.com", "total_gb": 50, "expiry_days": 30},
      {"email": "user2@example.com", "total_gb": 100, "expiry_days": 60}
    ]
  }'
```

### Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ñ‚Ñ€Ğ°Ñ„Ğ¸ĞºĞ°
```bash
curl -u admin:password "https://your-domain/my-panel/api/v1/traffic/stats?group_by=client"
```

### Ğ¡ĞºĞ°Ñ‡Ğ°Ñ‚ÑŒ Ğ²ÑĞµ backup
```bash
curl -u admin:password https://your-domain/my-panel/api/v1/backup/all \
  -o backups_$(date +%Y%m%d).zip
```

## ğŸ§ª Ğ›Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ°

### Backend
```bash
cd /opt/sub-manager
source venv/bin/activate
python3 backend/main.py
```

### Frontend (dev mode)
```bash
cd /opt/sub-manager/frontend
npm run dev
# ĞÑ‚ĞºÑ€Ğ¾Ğ¹Ñ‚Ğµ http://localhost:5173
```

### Production build
```bash
cd /opt/sub-manager/frontend
VITE_BASE="/my-panel/" npm run build
# Ğ¤Ğ°Ğ¹Ğ»Ñ‹ ÑĞ¾Ğ±Ğ¸Ñ€Ğ°ÑÑ‚ÑÑ Ğ² /opt/sub-manager/backend/build
# Ğ”Ğ»Ñ Ñ€Ğ°Ğ·Ğ¼ĞµÑ‰ĞµĞ½Ğ¸Ñ Ğ² ĞºĞ¾Ñ€Ğ½Ğµ: npm run build (VITE_BASE Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ "/")
```

### Ğ¢ĞµÑÑ‚Ñ‹ Ğ¸ Ğ»Ğ¸Ğ½Ñ‚
```bash
# Frontend lint + build
cd /opt/sub-manager/frontend
npm run lint
npm run build

# Backend unit-Ñ‚ĞµÑÑ‚Ñ‹
cd /opt/sub-manager
source venv/bin/activate
pip install -r backend/requirements-dev.txt
pytest -q backend/tests
```

## ğŸ› ï¸ Ğ”Ğ¸Ğ°Ğ³Ğ½Ğ¾ÑÑ‚Ğ¸ĞºĞ°

- Ğ›Ğ¾Ğ³Ğ¸ backend: `journalctl -u sub-manager -f`
- Ğ›Ğ¾Ğ³Ğ¸ Nginx: `tail -f /var/log/nginx/error.log`
- ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ ÑĞµÑ€Ğ²Ğ¸ÑĞ°: `systemctl status sub-manager`
- ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° API health: `curl -u admin:password https://your-domain/my-panel/api/v1/health/deps`

## ğŸ‘¥ Ğ£Ñ‡Ğ°ÑÑ‚Ğ¸Ğµ Ğ² Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞµ

1. Fork Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ñ
2. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹Ñ‚Ğµ feature branch
3. Commit Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ
4. Push Ğ² branch
5. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹Ñ‚Ğµ Pull Request

## ğŸ“„ Ğ›Ğ¸Ñ†ĞµĞ½Ğ·Ğ¸Ñ

MIT License - Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ ÑĞ²Ğ¾Ğ±Ğ¾Ğ´Ğ½Ğ¾!

## ğŸ™ Ğ‘Ğ»Ğ°Ğ³Ğ¾Ğ´Ğ°Ñ€Ğ½Ğ¾ÑÑ‚Ğ¸

- [FastAPI](https://fastapi.tiangolo.com/)
- [React](https://react.dev/)
- [Chart.js](https://www.chartjs.org/)
- [node panel](https://github.com/MHSanaei/node panel)
- [Vite](https://vitejs.dev/)
- [Bootstrap](https://getbootstrap.com/)

---

**Multi-Server Manager v3.1**
