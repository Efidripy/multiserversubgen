# üöÄ Multi-Server Subscription Manager (v3.0)

–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∞–º–∏ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤ node panel. –û–±—ä–µ–¥–∏–Ω—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (Email) —Å–æ –≤—Å–µ—Ö –≤–∞—à–∏—Ö –ø–∞–Ω–µ–ª–µ–π –≤ –µ–¥–∏–Ω—ã–µ —Å—Å—ã–ª–∫–∏ –ø–æ–¥–ø–∏—Å–æ–∫, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç Reality/TLS (VLESS, VMess, Trojan) –∏ –≤–µ–¥–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Å–∫–∞—á–∏–≤–∞–Ω–∏–π.

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- **Backend**: FastAPI (Python 3.10+)
- **Frontend**: React + TypeScript + Bootstrap 5
- **DB**: SQLite
- **Install/Config**: Bash-—Å–∫—Ä–∏–ø—Ç —Å –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ–º —Ñ–∞–π–ª–æ–≤

## ‚ú® –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

- **–ú—É–ª—å—Ç–∏–ø—Ä–æ—Ç–æ–∫–æ–ª—å–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞**: VLESS (Reality/TLS), VMess (Reality/TLS), Trojan (Reality/TLS)
- **API-first –¥–∏–∑–∞–π–Ω**: –ë—ç–∫–µ–Ω–¥ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç REST API, —Ñ—Ä–æ–Ω—Ç –ø–æ—Ç—Ä–µ–±–ª—è–µ—Ç –µ–≥–æ
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –í—Ö–æ–¥ —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π Linux (PAM), Basic Auth
- **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è**: –ò–Ω—Å—Ç–∞–ª–ª—è—Ç–æ—Ä —Å–∞–º –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç Nginx –∏ systemd
- **–û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å**: –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫, –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏

## üõ† –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–ø–æ–¥ root):

```bash
curl -sO https://raw.githubusercontent.com/efidripy/multiserversubgen/main/install.sh && bash install.sh
```

–°–∫—Ä–∏–ø—Ç —Å–ø—Ä–æ—Å–∏—Ç:
- –ò–º—è —Å–µ—Ä–≤–∏—Å–∞ (sub-manager –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- –ü–æ—Ä—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (666 –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- –ü—É—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ (my-panel –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- –ö–æ–Ω—Ñ–∏–≥ Nginx –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

## üìã –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- –û–°: Ubuntu 20.04 / 22.04 / 24.04 –∏–ª–∏ Debian 11/12
- –û–∫—Ä—É–∂–µ–Ω–∏–µ: Nginx —Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º –¥–æ–º–µ–Ω–æ–º –∏ SSL (Certbot)
- –î–æ—Å—Ç—É–ø: root
- Runtime: Python 3.10+, Node.js 18+ (—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
multiserversubgen/
‚îú‚îÄ‚îÄ install.sh              # –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Å—Ç–∞–ª–ª—è—Ç–æ—Ä
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îî‚îÄ‚îÄ main.py            # FastAPI –±—ç–∫–µ–Ω–¥ —Å API
‚îú‚îÄ‚îÄ frontend/
‚îÇ   ‚îú‚îÄ‚îÄ package.json       # NPM –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ vite.config.ts     # Build –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ tsconfig.json      # TypeScript –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ App.tsx        # –ì–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.tsx       # Entry point
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ components/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ NodeManager.tsx         # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —É–∑–ª–∞–º–∏
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ SubscriptionManager.tsx # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–æ–∫
‚îÇ   ‚îî‚îÄ‚îÄ index.html
‚îú‚îÄ‚îÄ systemd/
‚îÇ   ‚îî‚îÄ‚îÄ sub-manager.service         # Systemd unit
‚îî‚îÄ‚îÄ nginx/
    ‚îî‚îÄ‚îÄ sub-manager-location.conf   # Nginx –∫–æ–Ω—Ñ–∏–≥ (—Å–Ω–∏–ø–ø–µ—Ç)
```

## üîß –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

```bash
cd frontend
npm install       # –µ—Å–ª–∏ node_modules –Ω–µ—Ç
npm run dev       # dev-—Å–µ—Ä–≤–µ—Ä –Ω–∞ http://localhost:5173
```

–ü—Ä–æ–∫—Å–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ `http://localhost:666` –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤.

### –°–±–æ—Ä–∫–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

```bash
cd frontend
npm run build     # —Å–æ–±–µ—Ä—ë—Ç –≤ backend/build/
```

### –ó–∞–ø—É—Å–∫ –±—ç–∫–µ–Ω–¥–∞ –ª–æ–∫–∞–ª—å–Ω–æ

```bash
cd backend
python3 -m venv venv && source venv/bin/activate
pip install fastapi uvicorn requests python-pam urllib3
uvicorn main:app --host 127.0.0.1 --port 666 --reload
```

## üîå API

### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
–í—Å–µ API —Ç—Ä–µ–±—É—é—Ç Basic Auth (–∫—Ä–æ–º–µ `/health` –∏ `/sub/{email}`). –§—Ä–æ–Ω—Ç–µ–Ω–¥ —Å–æ–∑–¥–∞—ë—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Authorization: Basic base64(user:pass)`.

### Endpoints

| Method | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|----------|----------|
| GET | `/api/v1/health` | Health check (–±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏) |
| GET | `/api/v1/auth/verify` | –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ |
| GET | `/api/v1/nodes` | –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —É–∑–ª–æ–≤ |
| POST | `/api/v1/nodes` | –î–æ–±–∞–≤–∏—Ç—å —É–∑–µ–ª (body: `{name,url,user,password}`) |
| DELETE | `/api/v1/nodes/{id}` | –£–¥–∞–ª–∏—Ç—å —É–∑–µ–ª |
| GET | `/api/v1/emails` | –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ email –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É |
| GET | `/api/v1/sub/{email}` | –ü–æ–ª—É—á–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É (base64) |

## ‚ùì –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### 1. 404 –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –∞–¥–º–∏–Ω–∫–∏
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ URL –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è —Å–ª—ç—à–µ–º: `https://–≤–∞—à-–¥–æ–º–µ–Ω.com/my-panel/`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ location –±–ª–æ–∫ –Ω–µ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞–µ—Ç—Å—è –¥—Ä—É–≥–∏–º–∏ –ø—Ä–∞–≤–∏–ª–∞–º–∏

### 2. 401 –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ–∫–Ω–æ –≤—Ö–æ–¥–∞
- –í —Å–∫—Ä–∏–ø—Ç–µ –≤–∫–ª—é—á–µ–Ω–æ `proxy_intercept_errors off`
- –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ—Ç–∫—Ä—ã—Ç—å –≤ —Ä–µ–∂–∏–º–µ –ò–Ω–∫–æ–≥–Ω–∏—Ç–æ (Ctrl+Shift+N)

### 3. –ù–µ –ø—Ä–∏—Ö–æ–¥—è—Ç –¥–∞–Ω–Ω—ã–µ —Å node panel –ø–∞–Ω–µ–ª–µ–π
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—Ç—ã API –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö
- URL –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ `https://ip:port/base-path/`
- –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–π—Ç–∏ –≤ –ø–∞–Ω–µ–ª—å —á–µ—Ä–µ–∑ curl —Å —Ç–µ–º–∏ –∂–µ –∫—Ä–µ–¥–∞–º–∏

### 4. –ù–µ –ø—É—Å–∫–∞–µ—Ç –ø–æ–¥ root
–°–æ–∑–¥–∞–π—Ç–µ –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
```bash
useradd -m -s /bin/bash manager && passwd manager
```

## üóë –£–¥–∞–ª–µ–Ω–∏–µ

```bash
bash install.sh
```
–í—ã–±–µ—Ä–∏—Ç–µ "–£–¥–∞–ª–∏—Ç—å". –°–∫—Ä–∏–ø—Ç –æ—Ç–∫–∞—Ç–∏—Ç –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è.

## üìú –õ–∏—Ü–µ–Ω–∑–∏—è

Distributed under the MIT License.