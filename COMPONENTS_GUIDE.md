# Multi-Server Manager v3.1 - Components Guide

## üìã –û–±–∑–æ—Ä –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

–ü—Ä–æ–µ–∫—Ç —Ç–µ–ø–µ—Ä—å –≤–∫–ª—é—á–∞–µ—Ç –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º—É–ª—å—Ç–∏—Å–µ—Ä–≤–µ—Ä–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π 3X-UI/Xray.

---

## üé® –¢–µ–º—ã (Theme System)

### ThemeContext
**–§–∞–π–ª:** `frontend/src/contexts/ThemeContext.tsx`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–≤–µ—Ç–ª–æ–π –∏ —Ç–µ–º–Ω–æ–π —Ç–µ–º—ã
- –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—ã–±–æ—Ä–∞ –≤ localStorage
- –ï–¥–∏–Ω–∞—è —Ü–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞ –¥–ª—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ç–µ–º—ã –≤ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –≤—Ö–æ–¥–∞

**–¶–≤–µ—Ç–æ–≤—ã–µ —Å—Ö–µ–º—ã:**
- **Dark Theme:** GitHub-—Å—Ç–∏–ª—å —Ç–µ–º–Ω–∞—è —Ç–µ–º–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- **Light Theme:** –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞ —Å –º—è–≥–∫–∏–º–∏ —Ü–≤–µ—Ç–∞–º–∏

---

## üìä Dashboard (ServerStatus)

**–§–∞–π–ª:** `frontend/src/components/ServerStatus.tsx`

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- Real-time –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ CPU, RAM, Disk usage —Å –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞–º–∏
- –°—Ç–∞—Ç—É—Å Xray (–≤–µ—Ä—Å–∏—è, uptime, running/stopped)
- –°–µ—Ç–µ–≤–æ–π —Ç—Ä–∞—Ñ–∏–∫ (upload/download)
- –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ Xray
- Auto-refresh —Å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–º –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º
- –ò–Ω–¥–∏–∫–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä–æ–≤

**API Endpoints:**
- `GET /api/v1/servers/status` - —Å—Ç–∞—Ç—É—Å –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤
- `POST /api/v1/servers/{node_id}/restart-xray` - –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ Xray

---

## üì° Inbound Manager

**–§–∞–π–ª:** `frontend/src/components/InboundManager.tsx`

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö inbound —Å–æ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ø—Ä–æ—Ç–æ–∫–æ–ª—É, security, —É–∑–ª—É
- –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ inbound –Ω–∞ –¥—Ä—É–≥–∏–µ —Å–µ—Ä–≤–µ—Ä—ã
- –£–¥–∞–ª–µ–Ω–∏–µ inbound
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ Reality/TLS –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
- –°—Ç–∞—Ç—É—Å (Active/Disabled) –¥–ª—è –∫–∞–∂–¥–æ–≥–æ inbound

**API Endpoints:**
- `GET /api/v1/inbounds` - —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö inbound
- `POST /api/v1/inbounds/clone` - –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
- `DELETE /api/v1/inbounds/{id}` - —É–¥–∞–ª–µ–Ω–∏–µ

---

## üë• Client Manager

**–§–∞–π–ª:** `frontend/src/components/ClientManager.tsx`

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**

### –ü—Ä–æ—Å–º–æ—Ç—Ä –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è:
- –ü–æ–∏—Å–∫ –ø–æ email
- –§–∏–ª—å—Ç—Ä—ã –ø–æ —É–∑–ª—É, –ø—Ä–æ—Ç–æ–∫–æ–ª—É, —Å—Ç–∞—Ç—É—Å—É
- –°—Ç–∞—Ç—É—Å—ã: Active, Disabled, Expired, Depleted
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç—Ä–∞—Ñ–∏–∫–∞ (upload/download/total)
- –î–∞—Ç—ã –∏—Å—Ç–µ—á–µ–Ω–∏—è —Å—Ä–æ–∫–∞

### Batch –æ–ø–µ—Ä–∞—Ü–∏–∏:
- **Batch Add:** –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏–∑ —Å–ø–∏—Å–∫–∞
  - Email –∞–¥—Ä–µ—Å–∞ (–ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ —Å—Ç—Ä–æ–∫—É)
  - Total GB (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
  - Expiry Days (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- **Batch Delete:** –£–¥–∞–ª–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö/–∏—Å—Ç–µ–∫—à–∏—Ö/–∏—Å—á–µ—Ä–ø–∞–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
- **Reset Traffic:** –°–±—Ä–æ—Å —Ç—Ä–∞—Ñ–∏–∫–∞ –¥–ª—è –æ–¥–Ω–æ–≥–æ –∏–ª–∏ –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤

### –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö:
- –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV —Å –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
- –§–æ—Ä–º–∞—Ç: Email, Node, Protocol, Status, Upload, Download, Total, Expiry

**API Endpoints:**
- `GET /api/v1/clients` - —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
- `POST /api/v1/clients/batch-add` - –º–∞—Å—Å–æ–≤–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ
- `POST /api/v1/clients/batch-delete` - –º–∞—Å—Å–æ–≤–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ
- `POST /api/v1/clients/{id}/reset-traffic` - —Å–±—Ä–æ—Å —Ç—Ä–∞—Ñ–∏–∫–∞
- `POST /api/v1/automation/reset-all-traffic` - —Å–±—Ä–æ—Å –≤—Å–µ—Ö

---

## üìà Traffic Statistics

**–§–∞–π–ª:** `frontend/src/components/TrafficStats.tsx`

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**

### –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è (Chart.js):
- **Bar Chart:** Top N –ø–æ —Ç—Ä–∞—Ñ–∏–∫—É
  - –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞: Client / Inbound / Node
  - Upload/Download —Ä–∞–∑–¥–µ–ª—å–Ω–æ
- **Pie Chart:** –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ Upload/Download
- –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ç–µ–º

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
- Total Upload/Download/Traffic
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–Ω–ª–∞–π–Ω –∫–ª–∏–µ–Ω—Ç–æ–≤
- Top N —Ç–∞–±–ª–∏—Ü–∞ —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
- –°–ø–∏—Å–æ–∫ –æ–Ω–ª–∞–π–Ω –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏:
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞: –ø–æ –∫–ª–∏–µ–Ω—Ç—É, inbound –∏–ª–∏ —É–∑–ª—É
- Show Top: 5, 10, 20, 50

**API Endpoints:**
- `GET /api/v1/traffic/stats?group_by=client` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç—Ä–∞—Ñ–∏–∫–∞
- `GET /api/v1/clients/online` - –æ–Ω–ª–∞–π–Ω –∫–ª–∏–µ–Ω—Ç—ã

---

## üíæ Backup Manager

**–§–∞–π–ª:** `frontend/src/components/BackupManager.tsx`

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**

### –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –±—ç–∫–∞–ø–æ–≤:
- –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π backup –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
- –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –≤—Å–µ—Ö backup –æ–¥–Ω–∏–º –∞—Ä—Ö–∏–≤–æ–º (ZIP)
- –ü—Ä–æ–≥—Ä–µ—Å—Å-–∏–Ω–¥–∏–∫–∞—Ü–∏—è –¥–ª—è –∫–∞–∂–¥–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ: `backup_NodeName_YYYY-MM-DD.db`

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ:
- –í—ã–±–æ—Ä —É–∑–ª–∞ –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
- –ó–∞–≥—Ä—É–∑–∫–∞ .db —Ñ–∞–π–ª–∞
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ –∑–∞–º–µ–Ω–µ –ë–î
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞–∑–º–µ—Ä–µ —Ñ–∞–π–ª–∞

### –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è:
- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ cron –¥–ª—è –∞–≤—Ç–æ–±—ç–∫–∞–ø–∞
- –ü—Ä–∏–º–µ—Ä –∫–æ–º–∞–Ω–¥—ã —Å curl

**API Endpoints:**
- `GET /api/v1/backup/{node_id}` - —Å–∫–∞—á–∞—Ç—å backup —É–∑–ª–∞
- `GET /api/v1/backup/all` - —Å–∫–∞—á–∞—Ç—å –≤—Å–µ backup (ZIP)
- `POST /api/v1/backup/{node_id}/import` - –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å backup

---

## üîó Subscription Manager

**–§–∞–π–ª:** `frontend/src/components/SubscriptionManager.tsx`

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö email –ø–æ–¥–ø–∏—Å–æ–∫
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ email
- –î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
- Copy-–∫–Ω–æ–ø–∫–∞ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è URL
- –ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Å—ã–ª–æ–∫: `https://your-domain/sub/{email}`

---

## üñ•Ô∏è Node (Server) Manager

**–§–∞–π–ª:** `frontend/src/components/NodeManager.tsx`

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —É–∑–ª–æ–≤ 3X-UI
- –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —É–∑–ª–æ–≤ —Å IP –∏ –ø–æ—Ä—Ç–æ–º
- –£–¥–∞–ª–µ–Ω–∏–µ —É–∑–ª–æ–≤
- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è: Name, URL, Login, Password

---

## üéØ –ù–∞–≤–∏–≥–∞—Ü–∏—è (App.tsx)

**–í–∫–ª–∞–¥–∫–∏:**
1. **üìä Dashboard** - ServerStatus —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º
2. **üñ•Ô∏è Servers** - NodeManager + ServerStatus
3. **üì° Inbounds** - InboundManager
4. **üë• Clients** - ClientManager
5. **üìà Traffic** - TrafficStats
6. **üíæ Backup** - BackupManager
7. **üîó Subscriptions** - SubscriptionManager

**–ù–∞–≤–∏–≥–∞—Ü–∏—è:**
- Tab-based –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã (Light/Dark)
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
- Logout –∫–Ω–æ–ø–∫–∞

---

## üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### Backend (Python):
```
fastapi
uvicorn[standard]
requests
python-pam
urllib3
cryptography
python-multipart
aiofiles
```

### Frontend (Node.js):
```
react
react-dom
axios
bootstrap
chart.js
react-chartjs-2
typescript
vite
```

### –°–∏—Å—Ç–µ–º–Ω—ã–µ (Ubuntu 24):
```
python3-pip
python3-venv
python3-dev
libpam0g-dev
build-essential
sqlite3
nginx
fail2ban
psmisc
curl
wget
git
nodejs
npm
```

---

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
chmod +x install.sh
sudo ./install.sh
```

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç –≤—Å–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
2. –°–æ–∑–¥–∞—Å—Ç Python venv —Å –Ω—É–∂–Ω—ã–º–∏ –ø–∞–∫–µ—Ç–∞–º–∏
3. –°–æ–±–µ—Ä–µ—Ç React —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ (–≤–∫–ª—é—á–∞—è Chart.js)
4. –ù–∞—Å—Ç—Ä–æ–∏—Ç Nginx —Å proxy_pass
5. –°–æ–∑–¥–∞—Å—Ç systemd —Å–µ—Ä–≤–∏—Å
6. –ù–∞—Å—Ç—Ä–æ–∏—Ç fail2ban

---

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ

```bash
sudo ./update.sh
```

–ò–ª–∏ —á–µ—Ä–µ–∑ install.sh –≤—ã–±—Ä–∞—Ç—å –æ–ø—Ü–∏—é "–û–±–Ω–æ–≤–∏—Ç—å (—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ)".

---

## üé® –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è —Ç–µ–º—ã

–î–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ü–≤–µ—Ç–æ–≤–æ–π —Å—Ö–µ–º—ã –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ:
`frontend/src/contexts/ThemeContext.tsx`

```typescript
const lightTheme = {
  bg: { primary: '...', secondary: '...', tertiary: '...' },
  text: { primary: '...', secondary: '...' },
  accent: '...',
  success: '...',
  danger: '...',
  warning: '...',
  info: '...',
  border: '...'
};
```

---

## üìù API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Ñ–∞–π–ª–µ: `API_DOCUMENTATION.md`

–í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ç—Ä–µ–±—É—é—Ç Basic Auth:
```bash
curl -u username:password https://your-domain/api/v1/...
```

---

## üêõ Troubleshooting

### –§—Ä–æ–Ω—Ç–µ–Ω–¥ –Ω–µ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è:
```bash
cd frontend
rm -rf node_modules package-lock.json
npm install
npm run build
```

### Backend –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è:
```bash
systemctl status sub-manager
journalctl -u sub-manager -f
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å —Ç–µ–º–æ–π:
–û—á–∏—Å—Ç–∏—Ç—å localStorage:
```javascript
localStorage.removeItem('app_theme');
```

---

## üìß –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–î–ª—è –æ—Ç—á–µ—Ç–æ–≤ –æ–± –æ—à–∏–±–∫–∞—Ö —Å–æ–∑–¥–∞–π—Ç–µ issue —Å:
- –í–µ—Ä—Å–∏–µ–π –û–°
- –í–µ—Ä—Å–∏–µ–π Node.js (`node --version`)
- –í–µ—Ä—Å–∏–µ–π Python (`python3 --version`)
- –õ–æ–≥–∞–º–∏ –∏–∑ journalctl
- –°–∫—Ä–∏–Ω—à–æ—Ç–æ–º –æ—à–∏–±–∫–∏ (–µ—Å–ª–∏ frontend)
